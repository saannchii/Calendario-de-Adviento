<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Calendario de Adviento ğŸ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Manifest PWA -->
    <link rel="manifest" href="manifest.json">

    <!-- Iconos (Ãºtiles para iOS y PWA) -->
    <link rel="apple-touch-icon" href="img/icon-192.png">

    <link rel="stylesheet" href="calendario.css" />

    <!-- âœ… OneSignal V16 (SOLO ESTE) -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
</head>
<body>
<div class="app">

    <!-- VISTA CALENDARIO -->
    <section class="view view-calendar view-active" id="viewCalendar">
        <div class="container">
            <div class="calendar-header">
                <h1>Calendario de Adviento ğŸ„</h1>
                <div class="calendar-header-right">

                    <!-- ğŸ”” Campanita de notificaciones -->
                    <button class="notify-btn" id="notifyBtn" aria-label="Activar notificaciones">
                        <span class="notify-icon">ğŸ””</span>
                        <span class="notify-text">Recordatorio diario</span>
                        <span class="notify-pulse" aria-hidden="true"></span>
                    </button>

                    <!-- BotÃ³n modo desarrollador -->
                    <button class="dev-btn" id="devBtn">Modo desarrollador</button>
                </div>
            </div>

            <!-- ğŸ“Œ Mensaje especial iPhone -->
            <p class="iphone-hint hidden" id="iphoneHint">
                ğŸ“Œ En iPhone, para recibir notificaciones tienes que aÃ±adir esta web a la pantalla de inicio:
                <br>
                Compartir â†’ <b>AÃ±adir a pantalla de inicio</b>.
            </p>

            <p class="subtitle">
                Solo se revela el regalo del dÃ­a que toques. Luego podrÃ¡s volver atrÃ¡s para ver el calendario completo.
            </p>

            <p class="info" id="dateInfo"></p>
            <p class="legend">ğŸ‰ = acertado Â· ğŸ‘€ = abierto Â· ğŸ”’ = bloqueado</p>

            <div class="grid" id="daysGrid"></div>
        </div>
    </section>

    <!-- VISTA DETALLE DEL DÃA -->
    <section class="view view-day" id="viewDay">
        <div class="container container-day">
            <header class="day-header">
                <button class="back-btn" id="backBtn">â¬… Volver al calendario</button>
                <div class="day-header-title">
                    <h2 id="dayTitle">DÃ­a X</h2>
                    <p class="day-subtitle" id="dayStatus"></p>
                </div>
            </header>

            <div class="clue-box">
                <h3 class="clue-title">Pistas del regalo</h3>
                <ul class="clue-list" id="clueList"></ul>
            </div>

            <div class="guess-box">
                <p class="guess-title" id="guessTitle">
                    Tienes 3 intentos para adivinar quÃ© hay dentro.
                </p>

                <form class="guess-form" id="guessForm">
                    <input
                            type="text"
                            id="guessInput"
                            placeholder="Escribe aquÃ­ tu apuesta..."
                            autocomplete="off"
                    />
                    <button type="submit" id="guessButton">Enviar intento</button>
                </form>

                <div class="guess-info" id="guessInfo"></div>
                <p class="small">
                    Cada fallo revela una pista adicional, un poquito mÃ¡s claraâ€¦ pero sin decirlo todo.
                </p>
            </div>
        </div>
    </section>

    <!-- VISTA FINAL DÃA 24 -->
    <section class="view view-final" id="viewFinal">
        <div class="container container-final">
            <div class="final-layout">
                <!-- Texto -->
                <div class="final-inner">
                    <h2>Has llegado al final del calendario, mi amor â¤ï¸</h2>
                    <p class="final-text">
                        Ya hemos llegado al final del calendario mi amor. Quiero que sepas que todo esto me hace una ilusiÃ³n increÃ­ble,
                        me hace muchÃ­sima ilusiÃ³n todo lo que estamos construyendo y todo lo que te implique a ti en mi vida.
                        <br><br>
                        Me haces la persona mÃ¡s feliz del mundo y de verdad te lo digo, el conocerte, ha sido lo mejor que me ha podido pasar.
                        OjalÃ¡ poder seguir toda la vida haciendo este tipo de cosas contigo, me siento tan feliz y afortunado que es algo que ni puedo explicar.
                        <br><br>
                        Mil gracias por ser como eres conmigo, mil gracias por todo lo que haces por mÃ­ y en general, mil gracias por estar en mi vida.
                        <br><br>
                        Feliz Navidad mi vida, por nuestra primera Navidad como novios y por todas las que quedan.
                        <br><br>
                        Te amo con todo mi ser Victoria ğŸ§ğŸ’š
                    </p>
                    <button class="modal-btn" id="finalBackBtn">Volver al calendario</button>
                </div>

                <!-- Cuadro con secuencia de fotos y vÃ­deos -->
                <aside class="final-media-card">
                    <div class="final-media-frame">
                        <img
                                id="finalImage"
                                class="final-media final-media-active"
                                src="img/final1.jpeg"
                                alt="Recuerdo especial"
                        />
                        <video
                                id="finalVideo"
                                class="final-media"
                                muted
                                playsinline
                        ></video>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- VÃDEO DE NIEVE DE FONDO (siempre activo) -->
    <video id="snowVideo" class="snow-video" muted autoplay loop playsinline>
        <source src="video/nieve.mp4" type="video/mp4" />
    </video>

    <!-- MODAL FINAL CUANDO FALLA LOS 3 INTENTOS (dÃ­as 1â€“23) -->
    <div class="modal-backdrop hidden" id="endModalBackdrop">
        <div class="modal">
            <h3>Hasta aquÃ­ has llegado ğŸ</h3>
            <p class="modal-text">
                Creo que ni te haces una idea de lo que esâ€¦<br/>
                Mejor abre el regalo y espero de verdad que te encante. ğŸ’–
            </p>
            <button class="modal-btn" id="endModalCloseBtn">Volver al calendario</button>
        </div>
    </div>

    <!-- MODAL DE ACIERTO (dÃ­as 1â€“23) -->
    <div class="modal-backdrop hidden" id="successModalBackdrop">
        <div class="modal">
            <h3>Â¡Has dado en el clavo! ğŸ‰</h3>
            <p class="modal-text">
                DirÃ­a que te haces bastante idea de lo que esâ€¦<br/>
                Ahora solo queda esperar al momento perfecto para abrirlo. âœ¨
            </p>
            <button class="modal-btn" id="successModalCloseBtn">Volver al calendario</button>
        </div>
    </div>

    <!-- MODAL DE MODO DESARROLLADOR -->
    <div class="modal-backdrop hidden" id="devModalBackdrop">
        <div class="modal">
            <h3>Modo desarrollador</h3>
            <p class="modal-text">
                Introduce la contraseÃ±a para desbloquear todos los dÃ­as y poder probar el calendario.
            </p>
            <input
                    type="password"
                    id="devPasswordInput"
                    class="modal-input"
                    placeholder="ContraseÃ±a"
            />
            <div class="modal-actions">
                <button class="modal-btn secondary" id="devCancelBtn">Cancelar</button>
                <button class="modal-btn" id="devConfirmBtn">Aceptar</button>
            </div>
        </div>
    </div>

    <!-- AVISO SUPERIOR (toast) -->
    <div class="top-toast" id="topToast">
        ContraseÃ±a de desarrollador incorrecta
    </div>

</div>

<!-- MÃšSICA DE FONDO (loop + crossfade en JS) -->
<audio id="bgMusic" preload="auto">
    <source src="audio/musica.mp3" type="audio/mpeg" />
</audio>

<script src="calendario.js"></script>
</body>
</html>
